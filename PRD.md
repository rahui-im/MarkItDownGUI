MarkItDown GUI 변환기 PRD (Product Requirements Document)
1. 프로젝트 개요
1.1 제품명
MarkItDown GUI Converter - PyQt6 기반 문서 변환 도구
1.2 목적
Microsoft MarkItDown 라이브러리를 활용하여 다양한 문서 파일들을 Markdown 형식으로 변환할 수 있는 사용자 친화적인 GUI 애플리케이션 개발
1.3 대상 사용자

문서 변환이 필요한 개발자
기술 문서 작성자
콘텐츠 관리자
Markdown 형식으로 문서를 관리하고자 하는 모든 사용자

2. 기능 요구사항
2.1 핵심 기능
2.1.1 디렉토리 선택 및 파일 탐색

기능: 사용자가 변환할 문서들이 있는 디렉토리 선택
구현: QFileDialog를 이용한 폴더 선택
세부사항:

선택된 디렉토리 경로 표시
하위 디렉토리 포함 검색 옵션 제공
최근 사용한 디렉토리 히스토리 기능



2.1.2 지원 파일 타입 감지 및 리스트

지원 파일 형식:

Office 문서: .docx, .pptx, .xlsx, .xls
PDF: .pdf (OCR 지원)
이미지: .jpg, .jpeg, .png, .gif, .bmp, .tiff
오디오: .mp3, .wav
웹/텍스트: .html, .htm, .csv, .json, .xml, .txt
아카이브: .zip
전자책: .epub


기능:

파일 타입별 아이콘 표시
파일 크기 및 수정 날짜 표시
변환 가능 여부 상태 표시



2.1.3 멀티 파일 선택 및 변환

기능:

체크박스를 이용한 다중 파일 선택
"전체 선택/해제" 기능
선택된 파일 수 및 총 크기 표시


변환 프로세스:

진행률 표시 (Progress Bar)
실시간 변환 상태 업데이트
변환 성공/실패 결과 표시
에러 로그 기능



2.1.4 파일 저장 관리

저장 위치: 프로그램 실행 디렉토리의 /markdown 폴더
파일명 규칙: 원본파일명 + .md 확장자
중복 처리: 파일명 중복 시 자동 넘버링 (파일명_1.md, 파일명_2.md)
메타데이터 저장: 원본 파일 정보를 마크다운 헤더에 포함

2.2 부가 기능
2.2.1 일괄 다운로드 기능

기능: 변환된 모든 마크다운 파일을 ZIP 형태로 다운로드
구현:

ZIP 압축 기능
사용자 지정 다운로드 경로 선택
다운로드 진행률 표시



2.2.2 마크다운 파일 미리보기

기능: 변환된 마크다운 파일의 내용을 애플리케이션 내에서 확인
구현:

텍스트 에디터 위젯 (QTextEdit)
마크다운 렌더링 옵션 (HTML 변환 미리보기)
검색 기능 (Ctrl+F)
폰트 크기 조절



2.2.3 원본 파일 뷰어

기능: 선택한 원본 파일의 내용을 확인할 수 있는 기능
구현:

텍스트 파일: 직접 표시
이미지 파일: 이미지 뷰어
Office 문서: 기본 프로그램으로 열기 (외부 실행)
파일 정보 (크기, 생성일, 수정일) 표시



3. 사용자 인터페이스 설계
3.1 메인 윈도우 레이아웃
┌─────────────────────────────────────────────────────────────┐
│ MarkItDown GUI Converter                            [_][□][X]│
├─────────────────────────────────────────────────────────────┤
│ File  Edit  View  Tools  Help                              │
├─────────────────────────────────────────────────────────────┤
│ 📁 Directory: [C:\Documents\...      ] [Browse...]          │
│ □ Include subdirectories                                    │
├─────────────────────────────────────────────────────────────┤
│ ┌─── File List ─────────────────────────────────────────────┐│
│ │☑ [📄] document1.docx      125KB  2024-01-15             ││
│ │☑ [📊] spreadsheet.xlsx    89KB   2024-01-14             ││
│ │☐ [📋] presentation.pptx   2.1MB  2024-01-13             ││
│ │☑ [🖼] image.jpg           456KB  2024-01-12             ││
│ │                                                         ││
│ └─────────────────────────────────────────────────────────┘│
│ Selected: 3 files (670KB)    [Select All] [Select None]    │
├─────────────────────────────────────────────────────────────┤
│ [Convert Selected] [View Source] [Preview Markdown]         │
│ Progress: ████████████████████████████████ 100%             │
├─────────────────────────────────────────────────────────────┤
│ ┌─── Conversion Log ────────────────────────────────────────┐│
│ │✓ document1.docx → document1.md (Success)                ││
│ │✓ spreadsheet.xlsx → spreadsheet.md (Success)            ││
│ │✗ corrupted.pdf → Error: File corrupted                  ││
│ └─────────────────────────────────────────────────────────┘│
├─────────────────────────────────────────────────────────────┤
│ [Download All Markdown] [Open Markdown Folder]              │
└─────────────────────────────────────────────────────────────┘
3.2 추가 다이얼로그
3.2.1 마크다운 미리보기 창

탭 인터페이스 (Raw Markdown / Rendered HTML)
검색/바꾸기 기능
폰트 설정

3.2.2 설정 창

변환 옵션 설정
LLM 설정 (이미지 OCR용)
저장 경로 설정
테마 설정

4. 기술 사양
4.1 개발 환경

언어: Python 3.10+
GUI 프레임워크: PyQt6
핵심 라이브러리:

markitdown[all] - 문서 변환
PyQt6 - GUI
zipfile - 압축 기능
pathlib - 파일 경로 처리
asyncio - 비동기 변환 처리



4.2 시스템 요구사항

운영체제: Windows 10+, macOS 10.15+, Linux
메모리: 최소 2GB RAM
저장공간: 100MB (설치) + 변환 파일 용량

4.3 디렉토리 구조
markitdown_gui/
├── main.py                 # 메인 애플리케이션
├── ui/
│   ├── __init__.py
│   ├── main_window.py      # 메인 윈도우
│   ├── preview_dialog.py   # 미리보기 다이얼로그
│   ├── settings_dialog.py  # 설정 다이얼로그
│   └── components/         # UI 컴포넌트들
├── core/
│   ├── __init__.py
│   ├── converter.py        # 변환 로직
│   ├── file_manager.py     # 파일 관리
│   └── utils.py           # 유틸리티 함수들
├── resources/
│   ├── icons/             # 아이콘 파일들
│   └── styles/            # 스타일시트
├── markdown/              # 변환된 파일 저장 디렉토리
├── requirements.txt
└── README.md
5. 구현 단계
5.1 Phase 1 - 기본 기능 (2주)

 PyQt6 기본 윈도우 설정
 디렉토리 선택 기능
 파일 리스트 표시
 기본 변환 기능

5.2 Phase 2 - 고급 기능 (2주)

 멀티 파일 선택
 진행률 표시
 에러 처리
 로그 기능

5.3 Phase 3 - 부가 기능 (1주)

 미리보기 기능
 일괄 다운로드
 소스 파일 뷰어

5.4 Phase 4 - 최적화 및 배포 (1주)

 UI/UX 개선
 성능 최적화
 실행 파일 빌드
 문서화

6. 위험 요소 및 대응 방안
6.1 기술적 위험

위험: 대용량 파일 처리 시 메모리 부족
대응: 스트림 기반 처리, 청크 단위 변환
위험: 특정 파일 형식 변환 실패
대응: 에러 처리 강화, 대체 변환 옵션 제공

6.2 사용성 위험

위험: 복잡한 인터페이스로 인한 사용성 저하
대응: 직관적 UI 설계, 도움말 기능 강화

7. 품질 보증
7.1 테스트 계획

단위 테스트: 각 변환 기능별
통합 테스트: UI-백엔드 연동
사용자 테스트: 실제 사용 시나리오 기반

7.2 성능 기준

변환 속도: 1MB 문서 기준 5초 이내
메모리 사용: 최대 500MB
UI 응답성: 버튼 클릭 후 0.1초 이내 반응